// ===================================
// –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã SteamTable
// ===================================

// –ò–º–µ–Ω–∞ –ª–∏—Å—Ç–æ–≤
const SHEET_NAMES = {
  INVEST: 'Invest',
  SALES: 'Sales',
  HISTORY: 'History',
  AUTO_LOG: 'AutoLog',
  LOG: 'Log'
}

// –ë–∞–∑–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
const DATA_START_ROW = 2  // –°—Ç—Ä–æ–∫–∞ –Ω–∞—á–∞–ª–∞ –¥–∞–Ω–Ω—ã—Ö (1 - –∑–∞–≥–æ–ª–æ–≤–æ–∫)
const HEADER_ROW = 1
const ROW_HEIGHT = 85
const HEADER_HEIGHT = 35

// Steam –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
const STEAM_APP_ID = 570  // Dota 2
const STEAM_FEE = 0.85  // –ö–æ–º–∏—Å—Å–∏—è Steam 15%

// –§–æ—Ä–º–∞—Ç—ã —á–∏—Å–µ–ª
const NUMBER_FORMATS = {
  CURRENCY: '#,##0.00 ‚ÇΩ',
  PERCENT: '0.00%',
  INTEGER: '0'
}

// –°—Ç–∞—Ç—É—Å—ã –æ–ø–µ—Ä–∞—Ü–∏–π
const STATUS = {
  OK: '‚úì',
  ERROR: '‚ùå',
  WARNING: '‚ö†Ô∏è',
  MISSING: 'üÜï',
  NO_VALUES: '‚ùì',
  NONE: ''
}

// –¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞
const COLORS = {
  // –§–æ–Ω
  BACKGROUND: '#f3f3f3',  // –°–≤–µ—Ç–ª–æ-—Å–µ—Ä—ã–π —Ñ–æ–Ω –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
  WHITE: '#ffffff',
  TRANSPARENT: null,
  
  // –ü—Ä–∏–±—ã–ª—å/—É–±—ã—Ç–æ–∫
  PROFIT: '#c8e6c9',      // –°–≤–µ—Ç–ª–æ-–∑–µ–ª–µ–Ω—ã–π –¥–ª—è –ø—Ä–∏–±—ã–ª–∏
  LOSS: '#ffcdd2',        // –°–≤–µ—Ç–ª–æ-–∫—Ä–∞—Å–Ω—ã–π –¥–ª—è —É–±—ã—Ç–∫–æ–≤
  STABLE: '#fff9c4',      // –ñ–µ–ª—Ç—ã–π –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
  
  // –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ
  DUPLICATE: '#e3f2fd',   // –ì–æ–ª—É–±–æ–π –¥–ª—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
  WATCHLIST: '#e1f5fe',   // –§–∏–æ–ª–µ—Ç–æ–≤—ã–π –¥–ª—è –Ω–∞–±–ª—é–¥–µ–Ω–∏—è
  
  // –¢—Ä–µ–Ω–¥—ã (History)
  TREND_UP: '#c8e6c9',     // –†–æ—Å—Ç
  TREND_DOWN: '#ffcdd2',   // –ü–∞–¥–µ–Ω–∏–µ
  TREND_SIDEWAYS: '#fff9c4', // –ë–æ–∫–æ–≤–∏–∫
  TREND_UNKNOWN: '#e1f5fe'  // –ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å
}

// –ò–Ω—Ç–µ—Ä–≤–∞–ª—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
const UPDATE_INTERVALS = {
  PRICES_MINUTES: 10,     // –ò–Ω—Ç–µ—Ä–≤–∞–ª —Å–±–æ—Ä–∞ —Ü–µ–Ω (–∫–∞–∂–¥—ã–µ 10 –º–∏–Ω—É—Ç) - –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è —Å–±–æ—Ä–∞
  MORNING_HOUR: 0,        // –ù–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞ "–Ω–æ—á—å" (00:10) - –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ "–Ω–æ—á—å"
  MORNING_MINUTE: 10,     // –ú–∏–Ω—É—Ç–∞ –Ω–∞—á–∞–ª–∞ –ø–µ—Ä–∏–æ–¥–∞ "–Ω–æ—á—å" (00:10)
  EVENING_HOUR: 12,       // –ù–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞ "–¥–µ–Ω—å" (12:00) - –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ "–¥–µ–Ω—å"
  EVENING_MINUTE: 0       // –ú–∏–Ω—É—Ç–∞ –Ω–∞—á–∞–ª–∞ –ø–µ—Ä–∏–æ–¥–∞ "–¥–µ–Ω—å" (12:00)
}

// –ü–µ—Ä–∏–æ–¥—ã —Å–±–æ—Ä–∞ —Ü–µ–Ω
const PRICE_COLLECTION_PERIODS = {
  MORNING: 'morning',     // –ü–µ—Ä–∏–æ–¥ "–Ω–æ—á—å" (00:10-12:00) - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
  EVENING: 'evening'      // –ü–µ—Ä–∏–æ–¥ "–¥–µ–Ω—å" (12:00-00:10) - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
}

// –¢–∞–π–º–∞—É—Ç—ã –∏ –ª–∏–º–∏—Ç—ã
const LIMITS = {
  TIME_BUDGET_MS: 330000,  // 5.5 –º–∏–Ω—É—Ç –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—é
  MAX_ATTEMPTS: 2,         // –ü–æ–ø—ã—Ç–æ–∫ –ø–æ–ª—É—á–µ–Ω–∏—è —Ü–µ–Ω—ã
  BASE_DELAY_MS: 200,      // –ë–∞–∑–æ–≤–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞
  BETWEEN_ITEMS_MS: 150,   // –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø—Ä–µ–¥–º–µ—Ç–∞–º–∏
  LOCK_TIMEOUT_SEC: 300    // –¢–∞–π–º–∞—É—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (5 –º–∏–Ω—É—Ç)
}

// –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞ —Ç—Ä–µ–Ω–¥–æ–≤ (–∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–∞ –ø–æ–¥ Dota 2 –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å ¬±10-30%)
const TREND_ANALYSIS_CONFIG = {
  // –ú–µ—Ç–æ–¥ 1: –ü—Ä–æ—Å—Ç–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π
  SIMPLE_COMPARISON: {
    BASE_THRESHOLD: 0.08,        // 8% –≤–º–µ—Å—Ç–æ 5% (–¥–ª—è Dota 2 –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏)
    VOLATILITY_MULTIPLIER: 1.5,  // –£–º–µ–Ω—å—à–µ–Ω–æ —Å 2 (–º–µ–Ω—å—à–µ –≤–ª–∏—è–Ω–∏–µ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏)
    SIDEWAYS_FACTOR: 0.4         // 40% –æ—Ç –ø–æ—Ä–æ–≥–∞ –¥–ª—è –±–æ–∫–æ–≤–∏–∫–∞ (–≤–º–µ—Å—Ç–æ 50%)
  },
  
  // –ú–µ—Ç–æ–¥ 2: –°–∫–æ–ª—å–∑—è—â–∏–µ —Å—Ä–µ–¥–Ω–∏–µ
  MOVING_AVERAGES: {
    SHORT_WINDOW: 3,             // –û–∫–Ω–æ –∫–æ—Ä–æ—Ç–∫–æ–π MA
    LONG_WINDOW: 7,              // –û–∫–Ω–æ –¥–ª–∏–Ω–Ω–æ–π MA
    BASE_THRESHOLD: 0.02,        // 2% –≤–º–µ—Å—Ç–æ 1%
    VOLATILITY_MULTIPLIER: 1.5   // –£–º–µ–Ω—å—à–µ–Ω–æ —Å 2
  },
  
  // –ú–µ—Ç–æ–¥ 3: –õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è
  LINEAR_REGRESSION: {
    WINDOW: 20,                  // –û–∫–Ω–æ –∞–Ω–∞–ª–∏–∑–∞ (–º–∞–∫—Å –∏–ª–∏ –≤–µ—Å—å –Ω–∞–±–æ—Ä)
    GROWTH_THRESHOLD: 0.03,      // 3% –≤–º–µ—Å—Ç–æ 2% (–¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–æ—Å—Ç–∞)
    FALL_THRESHOLD: -0.03        // -3% –≤–º–µ—Å—Ç–æ -2% (–¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–∞–¥–µ–Ω–∏—è)
  },
  
  // –ú–µ—Ç–æ–¥ 4: Momentum –∞–Ω–∞–ª–∏–∑
  MOMENTUM: {
    WINDOW: 5,                   // –û–∫–Ω–æ –∞–Ω–∞–ª–∏–∑–∞
    BASE_THRESHOLD: 0.05,        // 5% –≤–º–µ—Å—Ç–æ 3%
    VOLATILITY_MULTIPLIER: 2     // –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
  },
  
  // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ–∞–∑—ã —Ü–∏–∫–ª–∞
  CYCLE_PHASE: {
    BOTTOM_THRESHOLD: 0.25,      // –ù–∏–∂–Ω–∏–µ 25% –¥–∏–∞–ø–∞–∑–æ–Ω–∞ = –¥–Ω–æ
    TOP_THRESHOLD: 0.75,         // –í–µ—Ä—Ö–Ω–∏–µ 25% –¥–∏–∞–ø–∞–∑–æ–Ω–∞ = –ø–∏–∫
    MIN_DATA_POINTS: 7           // –ú–∏–Ω–∏–º—É–º —Ç–æ—á–µ–∫ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ñ–∞–∑—ã
  },
  
  // –†–∞—Å—á–µ—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–∞ —Ä–æ—Å—Ç–∞
  GROWTH_POTENTIAL: {
    MIN_DATA_POINTS: 7,          // –ú–∏–Ω–∏–º—É–º —Ç–æ—á–µ–∫ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞
    PERCENTILE_TARGET: 0.85      // 85-–π –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—å –∫–∞–∫ —Ü–µ–ª–µ–≤–∞—è —Ü–µ–Ω–∞
  }
}

// –®–∏—Ä–∏–Ω—ã –∫–æ–ª–æ–Ω–æ–∫ (–≤ –ø–∏–∫—Å–µ–ª—è—Ö)
const COLUMN_WIDTHS = {
  IMAGE: 150,
  NAME: 250,
  NARROW: 80,
  MEDIUM: 100,
  WIDE: 120,
  EXTRA_WIDE: 200
}

// –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –∫–æ–ª–æ–Ω–æ–∫ –¥–ª—è Invest
const INVEST_COLUMNS = {
  IMAGE: 'A',
  NAME: 'B',
  QUANTITY: 'C',
  BUY_PRICE: 'D',
  CURRENT_PRICE: 'E',
  GOAL: 'F',
  TOTAL_INVESTMENT: 'G',
  CURRENT_VALUE: 'H',
  CURRENT_VALUE_AFTER_FEE: 'I',
  PROFIT: 'J',
  PROFIT_PERCENT: 'K',
  PROFIT_AFTER_FEE: 'L',
  LINK: 'M',
  MIN_PRICE: 'N',
  MAX_PRICE: 'O',
  TREND: 'P',
  DAYS_CHANGE: 'Q',
  PHASE: 'R',
  POTENTIAL: 'S',
  RECOMMENDATION: 'T',
  SELL_CHECKBOX: 'U'
}

// –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –∫–æ–ª–æ–Ω–æ–∫ –¥–ª—è Sales
const SALES_COLUMNS = {
  IMAGE: 'A',
  NAME: 'B',
  SELL_PRICE: 'C',
  CURRENT_PRICE: 'D',
  PRICE_DROP: 'E',
  LINK: 'F',
  MIN_PRICE: 'G',
  MAX_PRICE: 'H',
  TREND: 'I',
  DAYS_CHANGE: 'J',
  PHASE: 'K',
  POTENTIAL: 'L',
  RECOMMENDATION: 'M'
}

// –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –∫–æ–ª–æ–Ω–æ–∫ –¥–ª—è History
const HISTORY_COLUMNS = {
  IMAGE: 'A',
  NAME: 'B',
  STATUS: 'C',
  LINK: 'D',
  BUY_CHECKBOX: 'E',
  CURRENT_PRICE: 'F',
  MIN_PRICE: 'G',
  MAX_PRICE: 'H',
  TREND: 'I',
  DAYS_CHANGE: 'J',
  PHASE: 'K',
  POTENTIAL: 'L',
  RECOMMENDATION: 'M',
  // –î–∞—Ç—ã –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å N (–∫–æ–ª–æ–Ω–∫–∞ 14)
  FIRST_DATE_COL: 14
}

// –ó–∞–≥–æ–ª–æ–≤–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
const HEADERS = {
  INVEST: [
    '–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ(is)',
    '–ù–∞–∑–≤–∞–Ω–∏–µ',
    '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ',
    '–¶–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏',
    '–¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞',
    '–¶–µ–ª—å',
    '–û–±—â–∏–µ –≤–ª–æ–∂–µ–Ω–∏—è',
    '–¢–µ–∫—É—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å',
    '–¢–µ–∫—É—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å —Å –∫–æ–º–∏—Å—Å–∏–µ–π',
    '–ü—Ä–æ—Ñ–∏—Ç',
    '–ü—Ä–∏–±—ã–ª—å %',
    '–ü—Ä–∏–±—ã–ª—å % —Å –∫–æ–º–∏—Å—Å–∏–µ–π',
    '–°—Å—ã–ª–∫–∞',
    'Min',
    'Max',
    '–¢—Ä–µ–Ω–¥',
    '–î–Ω–µ–π —Å–º–µ–Ω—ã',
    '–§–∞–∑–∞',
    '–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª (P85)',
    '–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è',
    '–ü—Ä–æ–¥–∞—Ç—å?'
  ],
  
  SALES: [
    '–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ',
    '–ù–∞–∑–≤–∞–Ω–∏–µ',
    '–¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏',
    '–¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞',
    '–ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–æ—Å–∞–¥–∫–∏',
    '–°—Å—ã–ª–∫–∞',
    'Min',
    'Max',
    '–¢—Ä–µ–Ω–¥',
    '–î–Ω–µ–π —Å–º–µ–Ω—ã',
    '–§–∞–∑–∞',
    '–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª (P85)',
    '–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è'
  ],
  
  HISTORY: [
    '–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ',
    '–ù–∞–∑–≤–∞–Ω–∏–µ',
    '–°—Ç–∞—Ç—É—Å',
    '–°—Å—ã–ª–∫–∞',
    '–ö—É–ø–∏—Ç—å?',
    '–¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞',
    'Min',
    'Max',
    '–¢—Ä–µ–Ω–¥',
    '–î–Ω–µ–π —Å–º–µ–Ω—ã',
    '–§–∞–∑–∞',
    '–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª (P85)',
    '–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è'
    // –î–∞—Ç—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Å –∫–æ–ª–æ–Ω–∫–∏ N
  ]
}

