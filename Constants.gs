// ===================================
// –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã SteamTable
// ===================================

// –ò–º–µ–Ω–∞ –ª–∏—Å—Ç–æ–≤
const SHEET_NAMES = {
  INVEST: 'Invest',
  SALES: 'Sales',
  HISTORY: 'History',
  AUTO_LOG: 'AutoLog',
  LOG: 'Log',
  PORTFOLIO_STATS: 'PortfolioStats',
  HERO_STATS: 'HeroStats',
  HERO_MAPPING: 'HeroMapping',
  TELEGRAM_NOTIFICATIONS: 'TelegramNotifications'
}

// –ë–∞–∑–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
const DATA_START_ROW = 2  // –°—Ç—Ä–æ–∫–∞ –Ω–∞—á–∞–ª–∞ –¥–∞–Ω–Ω—ã—Ö (1 - –∑–∞–≥–æ–ª–æ–≤–æ–∫)
const HEADER_ROW = 1
const ROW_HEIGHT = 85
const HEADER_HEIGHT = 35

// Steam –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
const STEAM_APP_ID = 570  // Dota 2
const STEAM_FEE = 0.85  // –ö–æ–º–∏—Å—Å–∏—è Steam 15%

// –§–æ—Ä–º–∞—Ç—ã —á–∏—Å–µ–ª
const NUMBER_FORMATS = {
  CURRENCY: '#,##0.00 ‚ÇΩ',
  PERCENT: '0.00%',
  INTEGER: '0'
}

// –°—Ç–∞—Ç—É—Å—ã –æ–ø–µ—Ä–∞—Ü–∏–π
const STATUS = {
  OK: '‚úì',
  ERROR: '‚ùå',
  WARNING: '‚ö†Ô∏è',
  MISSING: 'üÜï',
  NO_VALUES: '‚ùì',
  NONE: ''
}

// –¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞
const COLORS = {
  // –§–æ–Ω
  BACKGROUND: '#f3f3f3',  // –°–≤–µ—Ç–ª–æ-—Å–µ—Ä—ã–π —Ñ–æ–Ω –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
  WHITE: '#ffffff',
  TRANSPARENT: null,
  
  // –ü—Ä–∏–±—ã–ª—å/—É–±—ã—Ç–æ–∫
  PROFIT: '#c8e6c9',      // –°–≤–µ—Ç–ª–æ-–∑–µ–ª–µ–Ω—ã–π –¥–ª—è –ø—Ä–∏–±—ã–ª–∏
  LOSS: '#ffcdd2',        // –°–≤–µ—Ç–ª–æ-–∫—Ä–∞—Å–Ω—ã–π –¥–ª—è —É–±—ã—Ç–∫–æ–≤
  STABLE: '#fff9c4',      // –ñ–µ–ª—Ç—ã–π –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
  
  // –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ
  DUPLICATE: '#e3f2fd',   // –ì–æ–ª—É–±–æ–π –¥–ª—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
  WATCHLIST: '#e1f5fe',   // –§–∏–æ–ª–µ—Ç–æ–≤—ã–π –¥–ª—è –Ω–∞–±–ª—é–¥–µ–Ω–∏—è
  
  // –¢—Ä–µ–Ω–¥—ã (History)
  TREND_UP: '#c8e6c9',     // –†–æ—Å—Ç
  TREND_DOWN: '#ffcdd2',   // –ü–∞–¥–µ–Ω–∏–µ
  TREND_SIDEWAYS: '#fff9c4', // –ë–æ–∫–æ–≤–∏–∫
  TREND_UNKNOWN: '#e1f5fe'  // –ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å
}

// –ò–Ω—Ç–µ—Ä–≤–∞–ª—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
const UPDATE_INTERVALS = {
  PRICES_MINUTES: 10,     // –ò–Ω—Ç–µ—Ä–≤–∞–ª —Å–±–æ—Ä–∞ —Ü–µ–Ω (–∫–∞–∂–¥—ã–µ 10 –º–∏–Ω—É—Ç) - –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è —Å–±–æ—Ä–∞
  MORNING_HOUR: 0,        // –ù–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞ "–Ω–æ—á—å" (00:10) - –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ "–Ω–æ—á—å"
  MORNING_MINUTE: 10,     // –ú–∏–Ω—É—Ç–∞ –Ω–∞—á–∞–ª–∞ –ø–µ—Ä–∏–æ–¥–∞ "–Ω–æ—á—å" (00:10)
  EVENING_HOUR: 12,       // –ù–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞ "–¥–µ–Ω—å" (12:00) - –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ "–¥–µ–Ω—å"
  EVENING_MINUTE: 0       // –ú–∏–Ω—É—Ç–∞ –Ω–∞—á–∞–ª–∞ –ø–µ—Ä–∏–æ–¥–∞ "–¥–µ–Ω—å" (12:00)
}

// –ü–µ—Ä–∏–æ–¥—ã —Å–±–æ—Ä–∞ —Ü–µ–Ω
const PRICE_COLLECTION_PERIODS = {
  MORNING: 'morning',     // –ü–µ—Ä–∏–æ–¥ "–Ω–æ—á—å" (00:10-12:00) - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
  EVENING: 'evening'      // –ü–µ—Ä–∏–æ–¥ "–¥–µ–Ω—å" (12:00-00:10) - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
}

// HTTP —Å—Ç–∞—Ç—É—Å –∫–æ–¥—ã
const HTTP_STATUS = {
  OK: 200,
  RATE_LIMIT: 429
}

// –¢–∞–π–º–∞—É—Ç—ã –∏ –ª–∏–º–∏—Ç—ã
const LIMITS = {
  TIME_BUDGET_MS: 330000,  // 5.5 –º–∏–Ω—É—Ç –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—é
  MAX_ATTEMPTS: 2,         // –ü–æ–ø—ã—Ç–æ–∫ –ø–æ–ª—É—á–µ–Ω–∏—è —Ü–µ–Ω—ã
  BASE_DELAY_MS: 200,      // –ë–∞–∑–æ–≤–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞
  BETWEEN_ITEMS_MS: 150,   // –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø—Ä–µ–¥–º–µ—Ç–∞–º–∏
  LOCK_TIMEOUT_SEC: 300,   // –¢–∞–π–º–∞—É—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (5 –º–∏–Ω—É—Ç)
  ERROR_MESSAGE_MAX_LENGTH: 200,  // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ
  // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏
  API_RETRY_DELAY_MS: 500,  // –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–æ–≤—Ç–æ—Ä–Ω—ã–º–∏ –ø–æ–ø—ã—Ç–∫–∞–º–∏ API
  API_BETWEEN_ITEMS_MS: 1000,  // –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø—Ä–µ–¥–º–µ—Ç–∞–º–∏ –ø—Ä–∏ batch –∑–∞–ø—Ä–æ—Å–∞—Ö
  API_BETWEEN_BATCHES_MS: 2000,  // –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–∞–∫–µ—Ç–∞–º–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
  TELEGRAM_MESSAGE_DELAY_MS: 500,  // –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ Telegram
  TELEGRAM_REPORT_DELAY_MS: 1000,  // –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –æ—Ç—á–µ—Ç–∞–º–∏ Telegram
  EVENT_HANDLER_DELAY_MS: 100,  // –ó–∞–¥–µ—Ä–∂–∫–∞ –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ —Å–æ–±—ã—Ç–∏–π
  HISTORY_UPDATE_DELAY_MS: 100,  // –ó–∞–¥–µ—Ä–∂–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ History
  METRICS_UPDATE_DELAY_MS: 500,  // –ó–∞–¥–µ—Ä–∂–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –º–µ—Ç—Ä–∏–∫
  // –¢–∞–π–º–∞—É—Ç—ã –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π
  SAFETY_BUFFER_MS: 1000,  // –ë—É—Ñ–µ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ–º —Ç–∞–π–º–∞—É—Ç–∞
  MIN_INTERVAL_MS: 100,  // –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
  MAX_ERROR_DELAY_MS: 250,  // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
  // –†–∞–∑–º–µ—Ä—ã –∫–æ–ª–æ–Ω–æ–∫ –¥–ª—è –ª–æ–≥–æ–≤
  LOG_COLUMN_WIDTHS: {
    AUTO_LOG: [150, 100, 200, 100],  // –î–∞—Ç–∞/–≤—Ä–µ–º—è, –õ–∏—Å—Ç, –î–µ–π—Å—Ç–≤–∏–µ, –°—Ç–∞—Ç—É—Å
    LOG: [150, 90, 120, 250, 90, 120, 120, 120]  // –î–∞—Ç–∞/–≤—Ä–µ–º—è, –¢–∏–ø, –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –ü—Ä–µ–¥–º–µ—Ç, –ö–æ–ª-–≤–æ, –¶–µ–Ω–∞ –∑–∞ —à—Ç, –°—É–º–º–∞, –ò—Å—Ç–æ—á–Ω–∏–∫
  }
}

// API –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
const API_CONFIG = {
  STEAM_WEB_API: {
    BASE_URL: 'https://steamwebapi.ru',
    TIMEOUT_MS: 30000,
    MAX_RETRIES: 3,
    RETRY_DELAY_MS: 500,
    MAX_ITEMS_PER_REQUEST: 50
  },
  STEAM_PRICE_HISTORY: {
    BASE_URL: 'https://steamcommunity.com/market/pricehistory',
    TIMEOUT_MS: 10000 // 10 —Å–µ–∫—É–Ω–¥ —Ç–∞–π–º–∞—É—Ç –¥–ª—è pricehistory
  },
  OPENDOTA: {
    BASE_URL: 'https://api.opendota.com/api',
    TIMEOUT_MS: 30000,
    MAX_RETRIES: 3,
    RETRY_DELAY_MS: 500
  }
}

// –ü–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≥–µ—Ä–æ–µ–≤ (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º–∞—è)
const HERO_STATS_UPDATE_SCHEDULE = {
  ENABLED: true,
  TIMES_PER_DAY: 3,  // –£—Ç—Ä–æ, –¥–µ–Ω—å, –≤–µ—á–µ—Ä
  HOURS: [8, 14, 20]  // 08:00, 14:00, 20:00
}

// –•—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ HeroStats (–≤ –¥–Ω—è—Ö)
const HERO_STATS_HISTORY_DAYS = 90

// –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞ —Ç—Ä–µ–Ω–¥–æ–≤ (–∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–∞ –ø–æ–¥ Dota 2 –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å ¬±10-30%)
const TREND_ANALYSIS_CONFIG = {
  // –ú–µ—Ç–æ–¥ 1: –ü—Ä–æ—Å—Ç–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π
  SIMPLE_COMPARISON: {
    BASE_THRESHOLD: 0.08,        // 8% –≤–º–µ—Å—Ç–æ 5% (–¥–ª—è Dota 2 –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏)
    VOLATILITY_MULTIPLIER: 1.5,  // –£–º–µ–Ω—å—à–µ–Ω–æ —Å 2 (–º–µ–Ω—å—à–µ –≤–ª–∏—è–Ω–∏–µ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏)
    SIDEWAYS_FACTOR: 0.4         // 40% –æ—Ç –ø–æ—Ä–æ–≥–∞ –¥–ª—è –±–æ–∫–æ–≤–∏–∫–∞ (–≤–º–µ—Å—Ç–æ 50%)
  },
  
  // –ú–µ—Ç–æ–¥ 2: –°–∫–æ–ª—å–∑—è—â–∏–µ —Å—Ä–µ–¥–Ω–∏–µ
  MOVING_AVERAGES: {
    SHORT_WINDOW: 3,             // –û–∫–Ω–æ –∫–æ—Ä–æ—Ç–∫–æ–π MA
    LONG_WINDOW: 7,              // –û–∫–Ω–æ –¥–ª–∏–Ω–Ω–æ–π MA
    BASE_THRESHOLD: 0.02,        // 2% –≤–º–µ—Å—Ç–æ 1%
    VOLATILITY_MULTIPLIER: 1.5   // –£–º–µ–Ω—å—à–µ–Ω–æ —Å 2
  },
  
  // –ú–µ—Ç–æ–¥ 3: –õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è
  LINEAR_REGRESSION: {
    WINDOW: 20,                  // –û–∫–Ω–æ –∞–Ω–∞–ª–∏–∑–∞ (–º–∞–∫—Å –∏–ª–∏ –≤–µ—Å—å –Ω–∞–±–æ—Ä)
    GROWTH_THRESHOLD: 0.03,      // 3% –≤–º–µ—Å—Ç–æ 2% (–¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–æ—Å—Ç–∞)
    FALL_THRESHOLD: -0.03        // -3% –≤–º–µ—Å—Ç–æ -2% (–¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–∞–¥–µ–Ω–∏—è)
  },
  
  // –ú–µ—Ç–æ–¥ 4: Momentum –∞–Ω–∞–ª–∏–∑
  MOMENTUM: {
    WINDOW: 5,                   // –û–∫–Ω–æ –∞–Ω–∞–ª–∏–∑–∞
    BASE_THRESHOLD: 0.05,        // 5% –≤–º–µ—Å—Ç–æ 3%
    VOLATILITY_MULTIPLIER: 2     // –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
  },
  
  // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ–∞–∑—ã —Ü–∏–∫–ª–∞
  CYCLE_PHASE: {
    BOTTOM_THRESHOLD: 0.25,      // –ù–∏–∂–Ω–∏–µ 25% –¥–∏–∞–ø–∞–∑–æ–Ω–∞ = –¥–Ω–æ
    TOP_THRESHOLD: 0.75,         // –í–µ—Ä—Ö–Ω–∏–µ 25% –¥–∏–∞–ø–∞–∑–æ–Ω–∞ = –ø–∏–∫
    MIN_DATA_POINTS: 7           // –ú–∏–Ω–∏–º—É–º —Ç–æ—á–µ–∫ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ñ–∞–∑—ã
  },
  
  // –†–∞—Å—á–µ—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–∞ —Ä–æ—Å—Ç–∞
  GROWTH_POTENTIAL: {
    MIN_DATA_POINTS: 7,          // –ú–∏–Ω–∏–º—É–º —Ç–æ—á–µ–∫ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞
    PERCENTILE_TARGET: 0.85      // 85-–π –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—å –∫–∞–∫ —Ü–µ–ª–µ–≤–∞—è —Ü–µ–Ω–∞
  }
}

// –®–∏—Ä–∏–Ω—ã –∫–æ–ª–æ–Ω–æ–∫ (–≤ –ø–∏–∫—Å–µ–ª—è—Ö)
const COLUMN_WIDTHS = {
  IMAGE: 150,
  NAME: 250,
  NARROW: 80,
  MEDIUM: 100,
  WIDE: 120,
  EXTRA_WIDE: 200
}

// –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –∫–æ–ª–æ–Ω–æ–∫ –¥–ª—è Invest
// –£–î–ê–õ–ï–ù–´: H (–¢–µ–∫—É—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –±–µ–∑ –∫–æ–º–∏—Å—Å–∏–∏), K (–ü—Ä–∏–±—ã–ª—å % –±–µ–∑ –∫–æ–º–∏—Å—Å–∏–∏)
// –û–°–¢–ê–í–õ–ï–ù–´: —Ç–æ–ª—å–∫–æ –∫–æ–ª–æ–Ω–∫–∏ —Å —É—á–µ—Ç–æ–º –∫–æ–º–∏—Å—Å–∏–∏
// –ù–û–í–ê–Ø –°–¢–†–£–ö–¢–£–†–ê: L - Min, M - Max, N - Investment Score, O - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è, P - –§–∞–∑–∞, Q - –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª, R - –¢—Ä–µ–Ω–¥ (–æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π), S - Hero Trend, T - Risk Level, U - –ü—Ä–æ–¥–∞—Ç—å (—É–±—Ä–∞–ª–∏ –ö—É–ø–∏—Ç—å?, –º–µ—Ç—Ä–∏–∫–∏ –∏ –î–Ω–µ–π —Å–º–µ–Ω—ã –∏–∑ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è)
const INVEST_COLUMNS = {
  IMAGE: 'A',
  NAME: 'B',
  QUANTITY: 'C',
  BUY_PRICE: 'D',
  CURRENT_PRICE: 'E',
  GOAL: 'F',
  TOTAL_INVESTMENT: 'G',
  CURRENT_VALUE_AFTER_FEE: 'H',  // –ë—ã–ª–æ I, —Å—Ç–∞–ª–æ H (—É–±—Ä–∞–ª–∏ H - –¢–µ–∫—É—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å)
  PROFIT: 'I',                    // –ë—ã–ª–æ J, —Å—Ç–∞–ª–æ I (–ü—Ä–æ—Ñ–∏—Ç - –ø—Ä–∏–±—ã–ª—å –≤ —Ä—É–±–ª—è—Ö —Å –∫–æ–º–∏—Å—Å–∏–µ–π)
  PROFIT_AFTER_FEE: 'J',          // –ë—ã–ª–æ L, —Å—Ç–∞–ª–æ J (—É–±—Ä–∞–ª–∏ K - –ü—Ä–∏–±—ã–ª—å % –±–µ–∑ –∫–æ–º–∏—Å—Å–∏–∏)
  LINK: 'K',                      // –ë—ã–ª–æ M, —Å—Ç–∞–ª–æ K
  MIN_PRICE: 'L',                 // –ë—ã–ª–æ N, —Å—Ç–∞–ª–æ L
  MAX_PRICE: 'M',                 // –ë—ã–ª–æ O, —Å—Ç–∞–ª–æ M
  INVESTMENT_SCORE: 'N',  // –ù–û–í–ê–Ø: Investment Score (–ø–æ—Å–ª–µ Max)
  RECOMMENDATION: 'O',  // –ü–µ—Ä–µ–º–µ—â–µ–Ω–æ –∏–∑ Q
  PHASE: 'P',  // –ü–µ—Ä–µ–º–µ—â–µ–Ω–æ –∏–∑ O
  POTENTIAL: 'Q',  // –ü–µ—Ä–µ–º–µ—â–µ–Ω–æ –∏–∑ P
  TREND: 'R',  // –û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç: "üü® –ë–æ–∫–æ–≤–∏–∫ 39 –¥." (–æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã –¢—Ä–µ–Ω–¥ –∏ –î–Ω–µ–π —Å–º–µ–Ω—ã)
  HERO_TREND: 'S',  // –ù–û–í–ê–Ø: Hero Trend (–ø–µ—Ä–µ–º–µ—â–µ–Ω–æ –∏–∑ T, —É–±—Ä–∞–ª–∏ DAYS_CHANGE)
  RISK_LEVEL: 'T',  // –ù–û–í–ê–Ø: Risk Level (–ø–µ—Ä–µ–º–µ—â–µ–Ω–æ –∏–∑ U, –º–µ—Ç—Ä–∏–∫–∏ —É–¥–∞–ª–µ–Ω—ã –∏–∑ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è, –Ω–æ –æ—Å—Ç–∞—é—Ç—Å—è –≤ –∫–æ–¥–µ –¥–ª—è —Ä–∞—Å—á–µ—Ç–æ–≤)
  SELL_CHECKBOX: 'U'  // –ù–û–í–ê–Ø: –ü—Ä–æ–¥–∞—Ç—å (–ø–µ—Ä–µ–º–µ—â–µ–Ω–æ –∏–∑ V, —É–±—Ä–∞–ª–∏ BUY_CHECKBOX –∏ –º–µ—Ç—Ä–∏–∫–∏)
}

// –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –∫–æ–ª–æ–Ω–æ–∫ –¥–ª—è Sales
// –ù–û–í–ê–Ø –°–¢–†–£–ö–¢–£–†–ê: K - Buyback Score, L - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è, M - Hero Trend, N - Risk Level (–º–µ—Ç—Ä–∏–∫–∏ —É–¥–∞–ª–µ–Ω—ã –∏–∑ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è, –Ω–æ –æ—Å—Ç–∞—é—Ç—Å—è –≤ –∫–æ–¥–µ –¥–ª—è —Ä–∞—Å—á–µ—Ç–æ–≤)
const SALES_COLUMNS = {
  IMAGE: 'A',
  NAME: 'B',
  QUANTITY: 'C',  // –ù–û–í–ê–Ø: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ
  SELL_PRICE: 'D',  // –ë—ã–ª–æ C, —Å—Ç–∞–ª–æ D
  CURRENT_PRICE: 'E',  // –ë—ã–ª–æ D, —Å—Ç–∞–ª–æ E
  PRICE_DROP: 'F',  // –ë—ã–ª–æ E, —Å—Ç–∞–ª–æ F
  PRICE_DROP_PERCENT: 'G',  // –ù–û–í–ê–Ø: –ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–æ—Å–∞–¥–∫–∏
  LINK: 'H',  // –ë—ã–ª–æ F, —Å—Ç–∞–ª–æ H
  MIN_PRICE: 'I',  // –ë—ã–ª–æ G, —Å—Ç–∞–ª–æ I
  MAX_PRICE: 'J',  // –ë—ã–ª–æ H, —Å—Ç–∞–ª–æ J
  BUYBACK_SCORE: 'K',  // –ù–û–í–ê–Ø: Buyback Score (–ø–æ—Å–ª–µ Max)
  RECOMMENDATION: 'L',  // –ü–µ—Ä–µ–º–µ—â–µ–Ω–æ –∏–∑ L
  HERO_TREND: 'M',  // –ù–û–í–ê–Ø: Hero Trend
  RISK_LEVEL: 'N'  // –ù–û–í–ê–Ø: Risk Level (–º–µ—Ç—Ä–∏–∫–∏ —É–¥–∞–ª–µ–Ω—ã –∏–∑ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è, –Ω–æ –æ—Å—Ç–∞—é—Ç—Å—è –≤ –∫–æ–¥–µ –¥–ª—è —Ä–∞—Å—á–µ—Ç–æ–≤)
}

// –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –∫–æ–ª–æ–Ω–æ–∫ –¥–ª—è History
// –û–ë–™–ï–î–ò–ù–ï–ù–´: TREND –∏ DAYS_CHANGE –≤ –æ–¥–Ω—É –∫–æ–ª–æ–Ω–∫—É M (–¢—Ä–µ–Ω–¥) —Å —Ñ–æ—Ä–º–∞—Ç–æ–º "üü• –ü–∞–¥–∞–µ—Ç 35 –¥–Ω."
// –ù–û–í–ê–Ø –°–¢–†–£–ö–¢–£–†–ê: G - Min, H - Max, I - Investment Score, J - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è, K - –§–∞–∑–∞, L - –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª, M - –¢—Ä–µ–Ω–¥ (–æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π), N-S - Hero Stats, T+ - –î–∞—Ç—ã
const HISTORY_COLUMNS = {
  IMAGE: 'A',
  NAME: 'B',
  STATUS: 'C',
  LINK: 'D',
  BUY_CHECKBOX: 'E',
  CURRENT_PRICE: 'F',
  MIN_PRICE: 'G',
  MAX_PRICE: 'H',
  INVESTMENT_SCORE: 'I',  // –ù–û–í–ê–Ø: Investment Score (–ø–æ—Å–ª–µ Max)
  RECOMMENDATION: 'J',  // –ü–µ—Ä–µ–º–µ—â–µ–Ω–æ –∏–∑ L
  PHASE: 'K',  // –ü–µ—Ä–µ–º–µ—â–µ–Ω–æ –∏–∑ J
  POTENTIAL: 'L',  // –ü–µ—Ä–µ–º–µ—â–µ–Ω–æ –∏–∑ K
  TREND: 'M',  // –ü–µ—Ä–µ–º–µ—â–µ–Ω–æ –∏–∑ I, –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç: "üü• –ü–∞–¥–∞–µ—Ç 35 –¥–Ω." (–æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã –¢—Ä–µ–Ω–¥ –∏ –î–Ω–µ–π —Å–º–µ–Ω—ã)
  HERO_TREND: 'N',  // –ù–û–í–ê–Ø: Hero Trend (–ø–µ—Ä–µ–º–µ—â–µ–Ω–æ –∏–∑ O, —É–±—Ä–∞–ª–∏ DAYS_CHANGE)
  CONTEST_RATE_CHANGE_7D: 'O',  // –ù–û–í–ê–Ø: Contest Rate Change (7d) (–ø–µ—Ä–µ–º–µ—â–µ–Ω–æ –∏–∑ P)
  CONTEST_RATE_CURRENT: 'P',  // –ù–û–í–ê–Ø: Contest Rate (current) (–ø–µ—Ä–µ–º–µ—â–µ–Ω–æ –∏–∑ Q)
  PICK_RATE_CURRENT: 'Q',  // –ù–û–í–ê–Ø: Pick Rate (current) (–ø–µ—Ä–µ–º–µ—â–µ–Ω–æ –∏–∑ R)
  WIN_RATE_CURRENT: 'R',  // –ù–û–í–ê–Ø: Win Rate (current) (–ø–µ—Ä–µ–º–µ—â–µ–Ω–æ –∏–∑ S)
  HERO_NAME: 'S',  // –ù–û–í–ê–Ø: Hero Name (–ø–µ—Ä–µ–º–µ—â–µ–Ω–æ –∏–∑ T)
  // –î–∞—Ç—ã –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å T (–∫–æ–ª–æ–Ω–∫–∞ 20, –±—ã–ª–æ 21)
  FIRST_DATE_COL: 20
}

// –ó–∞–≥–æ–ª–æ–≤–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
const HEADERS = {
  INVEST: [
    '–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ',
    '–ù–∞–∑–≤–∞–Ω–∏–µ',
    '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ',
    '–¶–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏',
    '–¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞',
    '–¶–µ–ª—å',
    '–û–±—â–∏–µ –≤–ª–æ–∂–µ–Ω–∏—è',
    '–¢–µ–∫—É—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å —Å –∫–æ–º–∏—Å—Å–∏–µ–π',
    '–ü—Ä–æ—Ñ–∏—Ç',
    '–ü—Ä–∏–±—ã–ª—å % —Å –∫–æ–º–∏—Å—Å–∏–µ–π',
    '–°—Å—ã–ª–∫–∞',
    'Min',
    'Max',
    '–û—Ü–µ–Ω–∫–∞ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏',
    '–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è',
    '–§–∞–∑–∞',
    '–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª (P85)',
    '–¢—Ä–µ–Ω–¥',  // –û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç: "üü® –ë–æ–∫–æ–≤–∏–∫ 39 –¥."
    '–¢—Ä–µ–Ω–¥ –≥–µ—Ä–æ—è',
    '–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞',
    '–ü—Ä–æ–¥–∞—Ç—å'
  ],
  
  SALES: [
    '–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ',
    '–ù–∞–∑–≤–∞–Ω–∏–µ',
    '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ',
    '–¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏',
    '–¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞',
    '–ü—Ä–æ—Å–∞–¥–∫–∞',
    '–ü—Ä–æ—Å–∞–¥–∫–∞ %',
    '–°—Å—ã–ª–∫–∞',
    'Min',
    'Max',
    '–û—Ü–µ–Ω–∫–∞ –æ—Ç–∫—É–ø–∞',
    '–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è',
    '–¢—Ä–µ–Ω–¥ –≥–µ—Ä–æ—è',
    '–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞'
  ],
  
  HISTORY: [
    '–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ',
    '–ù–∞–∑–≤–∞–Ω–∏–µ',
    '–°—Ç–∞—Ç—É—Å',
    '–°—Å—ã–ª–∫–∞',
    '–ö—É–ø–∏—Ç—å',
    '–¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞',
    'Min',
    'Max',
    '–û—Ü–µ–Ω–∫–∞ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏',
    '–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è',
    '–§–∞–∑–∞',
    '–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª (P85)',
    '–¢—Ä–µ–Ω–¥',  // –û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç: "üü® –ë–æ–∫–æ–≤–∏–∫ 39 –¥."
    '–¢—Ä–µ–Ω–¥ –≥–µ—Ä–æ—è',
    '–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ—Å—Ç-—Ä–µ–π—Ç–∞ (7–¥)',
    '–ö–æ–Ω—Ç–µ—Å—Ç-—Ä–µ–π—Ç (—Ç–µ–∫—É—â–∏–π)',
    '–ü–∏–∫-—Ä–µ–π—Ç (—Ç–µ–∫—É—â–∏–π)',
    '–í–∏–Ω—Ä–µ–π—Ç (—Ç–µ–∫—É—â–∏–π)',
    '–ò–º—è –≥–µ—Ä–æ—è'
    // –î–∞—Ç—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Å –∫–æ–ª–æ–Ω–∫–∏ U (21)
  ],
  
  HERO_STATS: [
    'Hero ID',
    'Hero Name',
    'Rank Category'
    // –î–∞—Ç—ã/–≤—Ä–µ–º—è –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Å –∫–æ–ª–æ–Ω–∫–∏ D
  ],
  
  HERO_MAPPING: [
    'Item Name',
    'Image',
    'Hero Name',
    'Hero ID',
    'Auto-detected',
    'Category'
  ]
}

// –í–µ—Å–∞ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Å–∫–æ—Ä–æ–≤ (Analytics)
const ANALYTICS_WEIGHTS = {
  INVESTMENT_SCORE: {
    HERO_TREND: 0.35,
    VOLATILITY: 0.20,
    DEMAND_RATIO: 0.20,
    PRICE_MOMENTUM: 0.15,
    LIQUIDITY: 0.05,
    SALES_TREND: 0.05
  },
  BUYBACK_SCORE: {
    PRICE_DROP: 0.35,
    VOLATILITY: 0.25,
    HERO_TREND: 0.20,
    DEMAND_RATIO: 0.10,
    PRICE_MOMENTUM: 0.05,
    LIQUIDITY: 0.05
  },
  HERO_TREND_SCORE: {
    CONTEST_RATE_CHANGE: 0.40,
    PRO_CONTEST_RATE_CHANGE: 0.20,
    PICK_RATE: 0.25,
    BAN_RATE: 0.10,
    WIN_RATE: 0.05
  }
}

// –ü–æ—Ä–æ–≥–∏ –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
const ANALYTICS_THRESHOLDS = {
  INVESTMENT_SCORE_CRITICAL: 0.75,
  BUYBACK_SCORE_CRITICAL: 0.75,
  HERO_CHANGE_24H: 0.15,      // 15% –∑–∞ 24 —á–∞—Å–∞
  HERO_CHANGE_7D: 0.10,        // 10% –∑–∞ 7 –¥–Ω–µ–π
  PRICE_CHANGE_24H: 0.20       // 20% –∑–∞ 24 —á–∞—Å–∞
}

// –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è —Å–∏—Å—Ç–µ–º—ã Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
const TELEGRAM_NOTIFICATION_TYPES = {
  INVESTMENT_SCORE: 'investment_score',
  BUYBACK_SCORE: 'buyback_score',
  HERO_TREND: 'hero_trend',
  PRICE_CHANGE: 'price_change',
  GOAL_REACHED: 'goal_reached',
  DROP: 'drop'
}

// –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
const TELEGRAM_PRIORITY = {
  CRITICAL: 'critical',
  IMPORTANT: 'important',
  INFO: 'info'
}

// –ü–µ—Ä–∏–æ–¥—ã cooldown –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö)
const TELEGRAM_COOLDOWN_MS = {
  GOAL_REACHED: 24 * 60 * 60 * 1000,        // 24 —á–∞—Å–∞
  DROP: 24 * 60 * 60 * 1000,                 // 24 —á–∞—Å–∞
  INVESTMENT_SCORE: 6 * 60 * 60 * 1000,      // 6 —á–∞—Å–æ–≤
  BUYBACK_SCORE: 6 * 60 * 60 * 1000,         // 6 —á–∞—Å–æ–≤
  HERO_TREND: 12 * 60 * 60 * 1000,           // 12 —á–∞—Å–æ–≤
  PRICE_CHANGE: 24 * 60 * 60 * 1000          // 24 —á–∞—Å–∞
}

// –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –∫–æ–ª–æ–Ω–æ–∫ –¥–ª—è HeroStats
const HERO_STATS_COLUMNS = {
  HERO_ID: 'A',
  HERO_NAME: 'B',
  RANK_CATEGORY: 'C',
  // –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∫–æ–ª–æ–Ω–∫–∏ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å D (–∫–æ–ª–æ–Ω–∫–∞ 4)
  FIRST_DATA_COL: 4
}

// –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –∫–æ–ª–æ–Ω–æ–∫ –¥–ª—è HeroMapping
const HERO_MAPPING_COLUMNS = {
  ITEM_NAME: 'A',
  IMAGE: 'B',  // –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø—Ä–µ–¥–º–µ—Ç–æ–≤
  HERO_NAME: 'C',
  HERO_ID: 'D',
  AUTO_DETECTED: 'E',
  CATEGORY: 'F'  // –ë—ã–ª–æ G, —Ç–µ–ø–µ—Ä—å F –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è Verified
}

